# Tailscale overlay — rebuilds with tsnet support for secure remote access.
#
# Usage (with managed mode):
#   docker compose -f docker-compose.yml -f docker-compose.managed.yml -f docker-compose.tailscale.yml up
#
# Required:
#   GOCLAW_TSNET_AUTH_KEY — Tailscale auth key (from https://login.tailscale.com/admin/settings/keys)
#
# Optional:
#   GOCLAW_TSNET_HOSTNAME — Tailscale device name (default: goclaw-gateway)

services:
  goclaw:
    build:
      args:
        ENABLE_TSNET: "true"
    environment:
      - GOCLAW_TSNET_HOSTNAME=${GOCLAW_TSNET_HOSTNAME:-goclaw-gateway}
      - GOCLAW_TSNET_AUTH_KEY=${GOCLAW_TSNET_AUTH_KEY}
    volumes:
      - tsnet-state:/app/tsnet-state

volumes:
  tsnet-state:
